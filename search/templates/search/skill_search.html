{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}
{% load star_filters %}

{% block title %}Skill Search | SkillSwap{% endblock %}

{% block content %}
<div class="py-5">
  <div class="container bg-white p-4 p-md-5 rounded-4 shadow-lg">
    
    <h2 class="text-center text-primary fw-bold mb-3">üéØ Skill Search</h2>
    <p class="text-center text-muted mb-4">
      Find the skills you need. Share the skills you have. Connect with your community.
    </p>

    <form method="get" class="mb-5">
      <div class="row">
        {% for field in search_form %}
          <div class="col-md-6 mb-3">
            <label for="{{ field.id_for_label }}" class="form-label fw-semibold">{{ field.label }}</label>
            {% render_field field class="form-control rounded-pill stylish-select" %}
          </div>
        {% endfor %}
      </div>

      <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary px-4 py-2 rounded-pill">üîç Search</button>
        <a href="{% url 'skill_search' %}" class="btn btn-outline-secondary rounded-pill ms-2">‚ôªÔ∏è Reset</a>
      </div>
    </form>

    {% if request.GET %}
      <div class="row">
        {% for skill in skills %}
          <div class="col-md-6 col-lg-4 mb-4 d-flex">
            <div class="card shadow-sm rounded-4 border-0 w-100 d-flex flex-column">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title mb-2">
                  <a href="{% url 'skill_detail' skill.id %}?next=skill_search" class="text-decoration-none text-primary">
                    {{ skill.title }}
                  </a>
                </h5>
                <p class="card-text text-muted flex-grow-1">{{ skill.description|truncatewords:20 }}</p>
                <div class="mb-2">
                  <span class="badge bg-secondary me-1">{{ skill.category }}</span>
                  <span class="badge bg-info text-dark text-uppercase">{{ skill.get_skill_type_display }}</span>
                </div>
                {% if skill.average_rating %}
                  <div class="mb-1">
                    <span>{{ skill.average_rating|star_rating }}</span>
                    <small class="text-muted">({{ skill.review_count }} review{{ skill.review_count|pluralize }})</small>
                  </div>
                {% else %}
                  <p class="text-muted mb-0">No reviews yet.</p>
                {% endif %}
              </div>
            </div>
          </div>
        {% empty %}
          <div class="col-12">
            <p class="text-center text-danger fw-bold">No skills found matching your criteria.</p>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
